{% extends "base.html" %}

{% block title %}{{ product.name }} - HACOM{% endblock %}

{% block additional_styles %}
.product-container {
display: flex;
gap: 40px;
padding: 20px;
max-width: 1200px;
margin: 0 auto;
align-items: flex-start;
}

/* Left section: Image + Details */
.product-left {
display: flex;
flex-direction: column;
flex: 1;
max-width: 50%;
}

.product-image {
width: 100%;
max-width: 500px;
}

.product-image img {
width: 100%;
height: auto;
border-radius: 10px;
box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.product-details-section {
background: #f8f9fa;
padding: 15px;
border-radius: 8px;
margin-top: 20px;
}

/* Right section: Info + Merchant */
.product-right {
flex: 1;
display: flex;
flex-direction: column;
gap: 20px;
}

.product-info {
flex: 1;
}

.merchant-info {
align-self: flex-start; /* Moves it to the top */
padding: 15px;
background: #fff;
border-radius: 8px;
box-shadow: 0 2px 5px rgba(0,0,0,0.1);
text-align: center;
width: 100%;
}
.visit-store-btn {
display: inline-block;
padding: 12px 20px;
font-size: 16px;
font-weight: bold;
color: white;
background: linear-gradient(135deg, #ff7b00, #ff3d00); /* Gradient effect */
border: none;
border-radius: 25px; /* Rounded edges */
cursor: pointer;
text-decoration: none;
transition: all 0.3s ease-in-out;
box-shadow: 0 4px 10px rgba(255, 61, 0, 0.2);
}

.visit-store-btn:hover {
background: linear-gradient(135deg, #ff3d00, #ff7b00); /* Reverse gradient */
transform: translateY(-2px); /* Slight lift effect */
box-shadow: 0 6px 15px rgba(255, 61, 0, 0.3);
}

.visit-store-btn:active {
transform: translateY(1px); /* Slight press-down effect */
}

.product-title {
    font-size: 2em;
    color: #162938;
    margin-bottom: 10px;
}

.product-brand {
    color: #666;
    font-size: 1.2em;
    margin-bottom: 20px;
}

.product-price {
    font-size: 2em;
    color: #00C4FF;
    margin: 20px 0;
}

.product-rating {
    color: #ffa41c;
    margin: 10px 0;
}

.stock-info {
    color: #4CAF50;
    margin: 10px 0;
}

.product-category {
    display: inline-block;
    background: #f0f0f0;
    padding: 5px 15px;
    border-radius: 15px;
    color: #666;
}

.action-buttons {
    display: flex;
    gap: 20px;
    margin-top: 30px;
}

.add-to-cart, .add-to-wishlist {
    padding: 12px 25px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1.1em;
    transition: background 0.3s;
}

.add-to-cart {
    background: #162938;
    color: white;
}

.add-to-cart:hover {
    background: #2a3f54;
}

.add-to-wishlist {
    background: #f0f0f0;
    color: #162938;
}

.add-to-wishlist:hover {
    background: #e0e0e0;
}

.heart-button {
    background: none;
    border: none;
    font-size: 24px;
    color: #ccc;
    cursor: pointer;
    transition: color 0.3s;
    padding: 10px;
}

.heart-button.active {
    color: #ff4444;
}

.merchant-info {
    margin: 20px 0;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
}

.merchant-info h3 {
    color: #162938;
    margin-bottom: 10px;
}

.merchant-link {
    color: #00C4FF;
    text-decoration: none;
    font-weight: 500;
}

.merchant-link:hover {
    text-decoration: underline;
}

.reviews-section {
    margin-top: 40px;
    padding: 20px;
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.review-item {
    padding: 15px;
    border-bottom: 1px solid #eee;
}

.review-item:last-child {
    border-bottom: none;
}

.review-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.review-rating {
    color: #ffa41c;
}

.show-all-reviews {
    display: block;
    text-align: center;
    padding: 10px;
    margin-top: 20px;
    background: #f8f9fa;
    color: #162938;
    text-decoration: none;
    border-radius: 5px;
    transition: background 0.3s;
}

.show-all-reviews:hover {
    background: #e9ecef;
}

.similar-products {
    margin-top: 40px;
    position: relative;
}

.products-slider {
    display: flex;
    overflow-x: hidden;
    scroll-behavior: smooth;
    padding: 20px 0;
}

.product-slide {
    flex: 0 0 250px;
    margin-right: 20px;
    background: white;
    border-radius: 12px;
    padding: 15px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    display: flex;
    flex-direction: column;
    height: 400px; /* Fixed height for consistency */
}

.product-slide:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.15);
}

.product-slide .product-image {
    width: 100%;
    height: 200px;
    overflow: hidden;
    border-radius: 8px;
}

.product-slide .product-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.product-slide .product-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding: 10px 0;
}

.product-slide .product-info h3 {
    font-size: 1.1em;
    color: #162938;
    margin: 10px 0;
    /* Handle long product names */
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    height: 2.8em; /* Fixed height for 2 lines */
}

.product-slide .product-price {
    color: #00C4FF;
    font-size: 1.2em;
    font-weight: bold;
    margin: 8px 0;
}

.product-slide .button-container {
    margin-top: auto; /* Push button to bottom */
    padding-top: 10px;
}

.product-slide button.view-details {
    display: inline-block;
    padding: 12px 20px;
    font-size: 16px;
    font-weight: bold;
    color: white;
    background: linear-gradient(135deg, #ff7b00, #ff3d00);
    border: none;
    border-radius: 25px;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.3s ease-in-out;
    box-shadow: 0 4px 10px rgba(255, 61, 0, 0.2);
    width: 100%;
}

.slider-arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(22, 41, 56, 0.8);
    color: white;
    border: none;
    padding: 15px;
    cursor: pointer;
    border-radius: 50%;
    z-index: 2;
}

.slider-arrow.left {
    left: -20px;
}

.slider-arrow.right {
    right: -20px;
}

.slider-arrow:hover {
    background: rgba(22, 41, 56, 1);
}
.product-details-section {
margin-top: 30px;
padding: 20px;
background: #f8f9fa;
border-radius: 8px;
}

.product-details-section h3 {
color: #162938;
margin-bottom: 15px;
border-bottom: 2px solid #00C4FF;
padding-bottom: 8px;
}

.details-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
gap: 15px;
}

.detail-item {
display: flex;
align-items: baseline;
gap: 10px;
}

.detail-label {
font-weight: 600;
color: #2a3f54;
min-width: 120px;
}

.detail-value {
color: #666;
flex-grow: 1;
}

.tags {
display: flex;
flex-wrap: wrap;
gap: 8px;
}

.tag-pill {
background: #e0e0e0;
color: #444;
padding: 4px 12px;
border-radius: 15px;
font-size: 0.9em;
}

.product-slide button.view-details:hover {
    background: linear-gradient(135deg, #ff3d00, #ff7b00);
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(255, 61, 0, 0.3);
}

.product-slide button.view-details:active {
    transform: translateY(1px);
}
.helpful-count {
font-size: 14px;
color: #666;
margin-top: 5px;
}

{% endblock %}

{% block content %}
<div class="product-container">
    <div class="product-left">
        <div class="product-image">
            <img src="{{ product.image_url }}" alt="{{ product.name }}">
        </div>
        <div class="product-details-section">
            <h3>Product Details</h3>
            <div class="details-grid">
                {% if product.details %}
                {% for key, value in product.details.items() %}
                <div class="detail-item">
                    <span class="detail-label">{{ key|replace('_', ' ')|title }}:</span>
                    <span class="detail-value">
                        {% if value is iterable and value is not string %}
                            {{ value|join(', ') }}
                        {% else %}
                            {{ value }}
                        {% endif %}
                    </span>
                </div>
                {% endfor %}
                {% endif %}

                {% if product.language %}
                <div class="detail-item">
                    <span class="detail-label">Language:</span>
                    <span class="detail-value">{{ product.language }}</span>
                </div>
                {% endif %}

                {% if product.color and product.color is iterable and product.color is not string and product.color is not number %}
                <div class="detail-item">
                    <span class="detail-label">Color:</span>
                    <span class="detail-value">{{ product.color|join(', ') }}</span>
                </div>
                {% endif %}

                {% if product.tags %}
                <div class="detail-item">
                    <span class="detail-label">Tags:</span>
                    <span class="detail-value tags">
                        {% for tag in product.tags %}
                        <span class="tag-pill">{{ tag }}</span>
                        {% endfor %}
                    </span>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="product-right">
        <div class="product-info">
            <h1 class="product-title">{{ product.name }}</h1>
            <p class="product-brand">{{ product.brand }}</p>
            <p class="product-price">${{ "%.2f"|format(product.price) }}</p>
            {% if product.rating %}
            <p class="product-rating">Rating: {{ "%.1f"|format(product.rating) }}/5</p>
            {% endif %}
            <p class="stock-info">In Stock ({{ product.stock_quantity }} available)</p>
            <p class="product-category">{{ product.category }}</p>

            <div class="action-buttons">
                <button class="add-to-cart" onclick="addToCart('{{ product.id }}', 1)">Add to Cart</button>
                <button class="heart-button {% if in_wishlist %}active{% endif %}"
                        onclick="toggleWishlist('{{ product.id }}')"
                        id="wishlist-button">
                    <i class="fas fa-heart"></i>
                </button>
            </div>
        </div>

        <div class="merchant-info">
            <h3>Merchant: {{ product.merchant_id }}</h3>
            <button
                    class="merchant-button visit-store-btn"
                    onclick="window.location.href='/merchant/{{ product.merchant_id }}';">
                Visit Store
            </button>
        </div>
    </div>
</div>

<!-- Reviews Section -->
<div class="reviews-section">
    <h2>Customer Reviews</h2>
    {% if reviews %}
        <div class="reviews-list">
            {% for review in reviews %}
                <div class="review-item">
                    <div class="review-header">
                        <strong>{{ review.first_name }} {{ review.last_name }}</strong>
                        <span class="review-rating">
                            {% for i in range(5) %}
                                <i class="fas fa-star {% if i < review.rating %}filled{% endif %}"></i>
                            {% endfor %}
                        </span>
                    </div>
                    <p>{{ review.comment }}</p>
                    <small>{{ review.date }}</small>
                    <p class="helpful-count">Helpful: {{ review.helpful_count }} people found this helpful</p>
                </div>
            {% endfor %}
        </div>
        {% if total_reviews > 3 %}
            <a href="/product/{{ product.id }}/reviews" class="show-all-reviews">
                Show All Reviews ({{ total_reviews }})
            </a>
        {% endif %}
    {% else %}
        <p>No reviews available for this product.</p>
    {% endif %}
</div>

<!-- Similar Products Section -->
<div class="similar-products">
    <h2>Similar Products</h2>
    {% if similar_products %}
        {% if similar_products|length > 4 %}
            <button class="slider-arrow left" onclick="slideProducts('left', 'similarSlider')" id="similarLeftArrow" style="display: none;">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="slider-arrow right" onclick="slideProducts('right', 'similarSlider')" id="similarRightArrow">
                <i class="fas fa-chevron-right"></i>
            </button>
        {% endif %}
        <div class="products-slider" id="similarSlider">
            {% for similar_product in similar_products %}
                <div class="product-slide">
                    <div class="product-image">
                        <img src="{{ similar_product.image_url }}" alt="{{ similar_product.name }}" onerror="this.src='/static/images/default-product.jpg'">
                    </div>
                    <div class="product-info">
                        <h3>{{ similar_product.name }}</h3>
                        <p class="product-price">${{ "%.2f"|format(similar_product.price) }}</p>
                        <div class="button-container">
                            <button class="view-details" onclick="window.location.href='/product/{{ similar_product.id }}'">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No similar products found</p>
    {% endif %}
</div>

<!-- Frequently Bought Together Section -->
<div class="similar-products bought-together">
    <h2>Frequently Bought Together</h2>
    {% if bought_together %}
        {% if bought_together|length > 4 %}
            <button class="slider-arrow left" onclick="slideProducts('left', 'boughtTogetherSlider')" id="boughtTogetherLeftArrow" style="display: none;">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="slider-arrow right" onclick="slideProducts('right', 'boughtTogetherSlider')" id="boughtTogetherRightArrow">
                <i class="fas fa-chevron-right"></i>
            </button>
        {% endif %}
        <div class="products-slider" id="boughtTogetherSlider">
            {% for bought_product in bought_together %}
                <div class="product-slide">
                    <div class="product-image">
                        <img src="{{ bought_product.image_url }}" alt="{{ bought_product.name }}" onerror="this.src='/static/images/default-product.jpg'">
                    </div>
                    <div class="product-info">
                        <h3>{{ bought_product.name }}</h3>
                        <p class="product-price">${{ "%.2f"|format(bought_product.price) }}</p>
                        <div class="button-container">
                            <button class="view-details" onclick="window.location.href='/product/{{ bought_product.id }}'">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No frequently bought together products found</p>
    {% endif %}
</div>

<!-- Category Products Section -->
<div class="similar-products category-products">
    <h2>More from {{ product.category }}</h2>
    {% if category_products %}
        {% if category_products|length > 4 %}
            <button class="slider-arrow left" onclick="slideProducts('left', 'categorySlider')" id="categoryLeftArrow" style="display: none;">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="slider-arrow right" onclick="slideProducts('right', 'categorySlider')" id="categoryRightArrow">
                <i class="fas fa-chevron-right"></i>
            </button>
        {% endif %}
        <div class="products-slider" id="categorySlider">
            {% for category_product in category_products %}
                <div class="product-slide">
                    <div class="product-image">
                        <img src="{{ category_product.image_url }}" alt="{{ category_product.name }}" onerror="this.src='/static/images/default-product.jpg'">
                    </div>
                    <div class="product-info">
                        <h3>{{ category_product.name }}</h3>
                        <p class="product-price">${{ "%.2f"|format(category_product.price) }}</p>
                        <div class="button-container">
                            <button class="view-details" onclick="window.location.href='/product/{{ category_product.id }}'">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No additional products found in this category</p>
    {% endif %}
</div>

<!-- Similar Users Also Liked Section -->
<div class="similar-products user-recommendations">
    <h2>Similar Users Also Liked</h2>
    {% if similar_users_liked_products %}
        {% if similar_users_liked_products|length > 4 %}
            <button class="slider-arrow left" onclick="slideProducts('left', 'userLikedSlider')" id="userLikedLeftArrow" style="display: none;">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="slider-arrow right" onclick="slideProducts('right', 'userLikedSlider')" id="userLikedRightArrow">
                <i class="fas fa-chevron-right"></i>
            </button>
        {% endif %}
        <div class="products-slider" id="userLikedSlider">
            {% for liked_product in similar_users_liked_products %}
                <div class="product-slide">
                    <div class="product-image">
                        <img src="{{ liked_product.image_url }}" alt="{{ liked_product.name }}" onerror="this.src='/static/images/default-product.jpg'">
                    </div>
                    <div class="product-info">
                        <h3>{{ liked_product.name }}</h3>
                        <p class="product-price">${{ "%.2f"|format(liked_product.price) }}</p>
                        <div class="button-container">
                            <button class="view-details" onclick="window.location.href='/product/{{ liked_product.id }}'">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No recommendations available</p>
    {% endif %}
</div>

<!-- Recommended for You Section (Content-Based) -->
<div class="similar-products content-recommendations">
    <h2>Recommended for You</h2>
    {% if content_based_recommended_products %}
        {% if content_based_recommended_products|length > 4 %}
            <button class="slider-arrow left" onclick="slideProducts('left', 'contentRecSlider')" id="contentRecLeftArrow" style="display: none;">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="slider-arrow right" onclick="slideProducts('right', 'contentRecSlider')" id="contentRecRightArrow">
                <i class="fas fa-chevron-right"></i>
            </button>
        {% endif %}
        <div class="products-slider" id="contentRecSlider">
            {% for recommended_product in content_based_recommended_products %}
                <div class="product-slide">
                    <div class="product-image">
                        <img src="{{ recommended_product.image_url }}" alt="{{ recommended_product.name }}" onerror="this.src='/static/images/default-product.jpg'">
                    </div>
                    <div class="product-info">
                        <h3>{{ recommended_product.name }}</h3>
                        <p class="product-price">${{ "%.2f"|format(recommended_product.price) }}</p>
                        <div class="button-container">
                            <button class="view-details" onclick="window.location.href='/product/{{ recommended_product.id }}'">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No personalized recommendations available</p>
    {% endif %}
</div>

<!-- New Arrivals Section -->
<div class="similar-products new-arrivals">
    <h2>New Arrivals</h2>
    {% if new_arrivals %}
        {% if new_arrivals|length > 4 %}
            <button class="slider-arrow left" onclick="slideProducts('left', 'newArrivalsSlider')" id="newArrivalsLeftArrow" style="display: none;">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="slider-arrow right" onclick="slideProducts('right', 'newArrivalsSlider')" id="newArrivalsRightArrow">
                <i class="fas fa-chevron-right"></i>
            </button>
        {% endif %}
        <div class="products-slider" id="newArrivalsSlider">
            {% for product in new_arrivals %}
                <div class="product-slide">
                    <div class="product-image">
                        <img src="{{ product.image_url }}" alt="{{ product.name }}" onerror="this.src='/static/images/default-product.jpg'">
                    </div>
                    <div class="product-info">
                        <h3>{{ product.name }}</h3>
                        <p class="product-price">${{ "%.2f"|format(product.price) }}</p>
                        <div class="button-container">
                            <button class="view-details" onclick="window.location.href='/product/{{ product.id }}'">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No new arrivals available</p>
    {% endif %}
</div>

<!-- Best Sellers Section -->
<div class="similar-products best-sellers">
    <h2>Best Sellers</h2>
    {% if best_sellers %}
        {% if best_sellers|length > 4 %}
            <button class="slider-arrow left" onclick="slideProducts('left', 'bestSellersSlider')" id="bestSellersLeftArrow" style="display: none;">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="slider-arrow right" onclick="slideProducts('right', 'bestSellersSlider')" id="bestSellersRightArrow">
                <i class="fas fa-chevron-right"></i>
            </button>
        {% endif %}
        <div class="products-slider" id="bestSellersSlider">
            {% for product in best_sellers %}
                <div class="product-slide">
                    <div class="product-image">
                        <img src="{{ product.image_url }}" alt="{{ product.name }}" onerror="this.src='/static/images/default-product.jpg'">
                    </div>
                    <div class="product-info">
                        <h3>{{ product.name }}</h3>
                        <p class="product-price">${{ "%.2f"|format(product.price) }}</p>
                        <div class="button-container">
                            <button class="view-details" onclick="window.location.href='/product/{{ product.id }}'">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No best sellers available</p>
    {% endif %}
</div>

<!-- Seasonal Recommendations Section -->
<div class="similar-products seasonal">
    <h2>Seasonal Picks</h2>
    {% if seasonal_items %}
        {% if seasonal_items|length > 4 %}
            <button class="slider-arrow left" onclick="slideProducts('left', 'seasonalSlider')" id="seasonalLeftArrow" style="display: none;">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="slider-arrow right" onclick="slideProducts('right', 'seasonalSlider')" id="seasonalRightArrow">
                <i class="fas fa-chevron-right"></i>
            </button>
        {% endif %}
        <div class="products-slider" id="seasonalSlider">
            {% for product in seasonal_items %}
                <div class="product-slide">
                    <div class="product-image">
                        <img src="{{ product.image_url }}" alt="{{ product.name }}" onerror="this.src='/static/images/default-product.jpg'">
                    </div>
                    <div class="product-info">
                        <h3>{{ product.name }}</h3>
                        <p class="product-price">${{ "%.2f"|format(product.price) }}</p>
                        <div class="button-container">
                            <button class="view-details" onclick="window.location.href='/product/{{ product.id }}'">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No seasonal recommendations available</p>
    {% endif %}
</div>

<script>
function toggleWishlist(productId) {
    const button = document.getElementById('wishlist-button');
    const isActive = button.classList.contains('active');
    
    const url = isActive ? `/wishlist/remove/${productId}` : `/wishlist/add/${productId}`;
    
    fetch(url, {
        method: 'POST'
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            button.classList.toggle('active');
        } else {
            alert('Failed to update wishlist: ' + data.message);
        }
    })
    .catch(error => {
        console.error('Error:', error);
    });
}

function updateArrows(sliderId) {
    const slider = document.getElementById(sliderId);
    const leftArrow = document.getElementById(sliderId.replace('Slider', 'LeftArrow'));
    const rightArrow = document.getElementById(sliderId.replace('Slider', 'RightArrow'));
    
    if (leftArrow) {
        leftArrow.style.display = slider.scrollLeft > 0 ? 'block' : 'none';
    }
    
    if (rightArrow) {
        const remainingScroll = slider.scrollWidth - (slider.scrollLeft + slider.clientWidth);
        rightArrow.style.display = remainingScroll > 0 ? 'block' : 'none';
    }
}

function slideProducts(direction, sliderId) {
    const slider = document.getElementById(sliderId);
    const slideAmount = 270; // Width of slide + margin
    
    if (direction === 'left') {
        slider.scrollLeft -= slideAmount;
    } else {
        slider.scrollLeft += slideAmount;
    }
    
    // Update arrows after scrolling
    setTimeout(() => updateArrows(sliderId), 100);
}

// Initialize arrows on load
document.addEventListener('DOMContentLoaded', function() {
    updateArrows('similarSlider');
    updateArrows('categorySlider');
    updateArrows('userLikedSlider');
    updateArrows('contentRecSlider');
    updateArrows('boughtTogetherSlider');
    updateArrows('newArrivalsSlider');
    updateArrows('bestSellersSlider');
    updateArrows('seasonalSlider');
});

function addToCart(productId, quantity) {
    fetch(`/cart/add/${productId}`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ quantity: quantity })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('Product added to cart successfully!');
        } else {
            alert('Failed to add product to cart: ' + data.message);
        }
    })
    .catch(error => {
        console.error('Error:', error);
    });
}
</script>
{% endblock %} 